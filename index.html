<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Attendance-o-Meter 3000</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .holiday { background-color: #fde68a; cursor: not-allowed; }
    .attended { background-color: #bbf7d0; }
    .not-attended { background-color: #fecaca; }
  </style>
</head>
<body class="bg-gray-50 min-h-screen flex flex-col items-center p-6">
  <h1 class="text-3xl font-bold mb-4">Attendance-o-Meter 3000 ðŸŽ¯</h1>
  <p class="mb-6 text-gray-600">Track your August 2025 attendance with style</p>

  <div id="calendar" class="grid grid-cols-7 gap-2 mb-6"></div>

  <div id="progress" class="text-lg font-semibold mb-4"></div>
  <div id="message" class="text-xl font-bold text-green-600"></div>

  <button onclick="resetAttendance()" class="mt-6 px-4 py-2 bg-red-500 text-white rounded">Reset Attendance</button>

  <script>
    const month = 7; // August (0-indexed: Jan=0)
    const year = 2025;
    const holidays = ["2025-08-15", "2025-08-27"];
    const totalWorkingDays = getTotalWorkingDays();
    let attendance = JSON.parse(localStorage.getItem('attendanceData')) || {};

    function getTotalWorkingDays() {
      let days = 0;
      const daysInMonth = new Date(year, month + 1, 0).getDate();
      for (let d = 1; d <= daysInMonth; d++) {
        const date = new Date(year, month, d);
        const dateStr = date.toISOString().split('T')[0];
        const dayOfWeek = date.getDay(); // 0=Sun, 6=Sat
        if (!holidays.includes(dateStr) && dayOfWeek !== 0 && dayOfWeek !== 6) {
          days++;
        }
      }
      return days;
    }

    function renderCalendar() {
      const calendar = document.getElementById('calendar');
      calendar.innerHTML = '';
      const firstDay = new Date(year, month, 1).getDay();
      const daysInMonth = new Date(year, month + 1, 0).getDate();

      // Empty slots for alignment
      for (let i = 0; i < (firstDay === 0 ? 6 : firstDay - 1); i++) {
        calendar.innerHTML += `<div></div>`;
      }

      for (let d = 1; d <= daysInMonth; d++) {
        const date = new Date(year, month, d);
        const dateStr = date.toISOString().split('T')[0];
        let classes = "p-4 border rounded text-center";
        let text = d;

        if (holidays.includes(dateStr)) {
          classes += " holiday";
        } else {
          if (attendance[dateStr]) classes += " attended";
          classes += " cursor-pointer";
        }

        calendar.innerHTML += `<div class="${classes}" onclick="toggleAttendance('${dateStr}')">${text}</div>`;
      }

      updateProgress();
    }

    function toggleAttendance(dateStr) {
      if (holidays.includes(dateStr)) return;
      attendance[dateStr] = !attendance[dateStr];
      localStorage.setItem('attendanceData', JSON.stringify(attendance));
      renderCalendar();
    }

    function updateProgress() {
      const attendedDays = Object.values(attendance).filter(Boolean).length;
      const percentage = Math.round((attendedDays / totalWorkingDays) * 100);
      document.getElementById('progress').textContent = `Attendance: ${percentage}% (${attendedDays} of ${totalWorkingDays} working days)`;
      const msg = document.getElementById('message');
      msg.textContent = percentage >= 50 ? "ðŸŽ‰ Hooray! You're policy-compliant!" : "";
    }

    function resetAttendance() {
      attendance = {};
      localStorage.removeItem('attendanceData');
      renderCalendar();
    }

    renderCalendar();
  </script>
</body>
</html>
